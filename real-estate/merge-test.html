<!DOCTYPE html>
<html>

<head>
    <title>Choropleth Tutorial - Leaflet</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>
    <style>
    html,
    body,
    #map {
        height: 100%;
        width: 100%;
        padding: 0px;
        margin: 0px;
        background: white;
    }
    </style>
</head>

<body>
    <div id="map"></div>
    <script>
    var map = L.map('map').setView([39.74739, -105], 13);

    // set source for map tiles
    ATTR = '&copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
        '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a> | ' +
        '&copy; <a href="http://cartodb.com/attributions">CartoDB</a>';

    CDB_URL = 'http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png';

    // add tiles to map
    L.tileLayer(CDB_URL, { attribution: ATTR }).addTo(map);

    var campusGeom =
        // {
        //     "zipCode": 80237,
        //     "type": "Feature",
        //     "geometry": {
        //         "type": "MultiPolygon",
        //         "coordinates": [
        //             [
        //                 [
        //                     [-105.00432014465332, 39.74732195489861],
        //                     [-105.00715255737305, 39.74620006835170],
        //                     [-105.00921249389647, 39.74468219277038],
        //                     [-105.01067161560059, 39.74362625960105],
        //                     [-105.01195907592773, 39.74290029616054],
        //                     [-105.00989913940431, 39.74078835902781],
        //                     [-105.00758171081543, 39.74059036160317],
        //                     [-105.00346183776855, 39.74059036160317],
        //                     [-105.00097274780272, 39.74059036160317],
        //                     [-105.00062942504881, 39.74072235994946],
        //                     [-105.00020027160645, 39.74191033368865],
        //                     [-105.00071525573731, 39.74276830198601],
        //                     [-105.00097274780272, 39.74369225589818],
        //                     [-105.00097274780272, 39.74461619742136],
        //                     [-105.00123023986816, 39.74534214278395],
        //                     [-105.00183105468751, 39.74613407445653],
        //                     [-105.00432014465332, 39.74732195489861]
        //                 ],
        //                 [
        //                     [-105.00361204147337, 39.74354376414072],
        //                     [-105.00301122665405, 39.74278480127163],
        //                     [-105.00221729278564, 39.74316428375108],
        //                     [-105.00283956527711, 39.74390674342741],
        //                     [-105.00361204147337, 39.74354376414072]
        //                 ]
        //             ],
        //             [
        //                 [
        //                     [-105.00942707061768, 39.73989736613708],
        //                     [-105.00942707061768, 39.73910536278566],
        //                     [-105.00685214996338, 39.73923736397631],
        //                     [-105.00384807586671, 39.73910536278566],
        //                     [-105.00174522399902, 39.73903936209552],
        //                     [-105.00041484832764, 39.73910536278566],
        //                     [-105.00041484832764, 39.73979836621592],
        //                     [-105.00535011291504, 39.73986436617916],
        //                     [-105.00942707061768, 39.73989736613708]
        //                 ]
        //             ]
        //         ]
        //     }
        // }
        [{
                "zipCode": 80205,
                "type": "Feature",
                "geometry": {
                    "type": "Polygon",
                    "coordinates": [
                        [
                            [-105.05259301853266, 39.722334950274856],
                            [-105.05261901853275, 39.722935950274916],
                            [-105.05325901853273, 39.72408295027514],
                            [-105.05324001853307, 39.72544095027534],
                            [-105.05325301853323, 39.72579995027542],
                            [-105.05325401853362, 39.727232950275635],
                            [-105.05323801853464, 39.731293950276594],
                            [-105.05210001853531, 39.73128995027683],
                            [-105.05219501853522, 39.73134895027692],
                            [-105.05220201853565, 39.7331029502771],
                            [-105.05322701853521, 39.733109950277],
                            [-105.0532270185362, 39.73676995027774],
                            [-105.05321001853655, 39.73815195027814],
                            [-105.05320101853756, 39.741934950278925],
                            [-105.05321201853812, 39.743979950279325],
                            [-105.05208701853869, 39.74396995027934],
                            [-105.0500310185397, 39.74397695027971],
                            [-105.04868601854044, 39.743989950279946],
                            [-105.04632301854171, 39.74396995028026],
                            [-105.04402301854282, 39.74397195028079],
                            [-105.03873101854553, 39.743949950281625],
                            [-105.03815701854575, 39.74395695028177],
                            [-105.03576501854704, 39.74394995028211],
                            [-105.03577101854766, 39.746377950282586],
                            [-105.03695001854697, 39.74638795028236],
                            [-105.03695601854746, 39.74757795028264],
                            [-105.03578401854806, 39.74756195028292],
                            [-105.03459801854859, 39.74758095028295],
                            [-105.03347301854916, 39.74757895028309],
                            [-105.03330301854925, 39.747465950283186],
                            [-105.03277101854957, 39.74747095028331],
                            [-105.03230101854977, 39.74758095028348],
                            [-105.02806901855182, 39.74757995028405],
                            [-105.0252290185534, 39.7475759502845],
                            [-105.02050901855579, 39.74759895028525],
                            [-105.01896701855655, 39.747573950285584],
                            [-105.01898201855623, 39.74638395028525],
                            [-105.01895501855618, 39.74586095028522],
                            [-105.01882301855626, 39.74594795028533],
                            [-105.01862001855636, 39.74595895028521],
                            [-105.01847501855639, 39.74584495028523],
                            [-105.01823801855643, 39.745416950285104],
                            [-105.01789301855646, 39.745004950285264],
                            [-105.01756401855653, 39.74475695028516],
                            [-105.01741501855663, 39.74455895028513],
                            [-105.01626101855682, 39.74338895028505],
                            [-105.01567701855747, 39.744743950285425],
                            [-105.0155770185576, 39.745115950285594],
                            [-105.01560501855795, 39.7460749502857],
                            [-105.01567701855804, 39.74689195028596],
                            [-105.01546401855862, 39.74872495028638],
                            [-105.01536201855896, 39.74938295028663],
                            [-105.01513301855913, 39.749854950286704],
                            [-105.01436001855977, 39.75042795028695],
                            [-105.01349901856022, 39.750879950287086],
                            [-105.01296301856068, 39.75110795028728],
                            [-105.01252801856091, 39.751400950287476],
                            [-105.01223301856115, 39.751644950287535],
                            [-105.01167801856155, 39.75215495028764],
                            [-105.0113190185619, 39.752546950287694],
                            [-105.01082401856219, 39.75294895028807],
                            [-105.01026901856257, 39.753354950288085],
                            [-105.00992001856277, 39.753552950288245],
                            [-105.00948901856323, 39.75392595028837],
                            [-105.00906901856347, 39.754384950288454],
                            [-105.00857801856388, 39.75472995028876],
                            [-105.00818601856406, 39.75479095028874],
                            [-105.00816701856404, 39.75454495028874],
                            [-105.00798301856393, 39.75399595028856],
                            [-105.00791701856394, 39.7536999502887],
                            [-105.00782701856394, 39.753507950288565],
                            [-105.00760901856398, 39.753304950288474],
                            [-105.0069680185642, 39.75278995028851],
                            [-105.00604001856443, 39.75208395028852],
                            [-105.00661601856406, 39.75164095028844],
                            [-105.00636501856405, 39.751420950288356],
                            [-105.0041180185648, 39.74972395028826],
                            [-105.00373101856485, 39.749347950288396],
                            [-105.00308701856501, 39.74851295028815],
                            [-105.0025690185651, 39.74791195028832],
                            [-105.00228201856517, 39.74769395028825],
                            [-105.00111701856562, 39.74694995028835],
                            [-105.00081301856562, 39.7466899502883],
                            [-105.0005730185658, 39.746803950288204],
                            [-105.00051201856574, 39.74664795028822],
                            [-105.00043601856561, 39.74601595028822],
                            [-105.00042101856559, 39.74551895028808],
                            [-105.00014801856574, 39.745752950288136],
                            [-104.99895901856662, 39.74666495028866],
                            [-104.99804701856678, 39.7459879502886],
                            [-104.99717601856707, 39.74532295028848],
                            [-104.99635001856737, 39.74466495028854],
                            [-104.99749801856659, 39.74371495028827],
                            [-104.99738301856651, 39.74361195028807],
                            [-104.9980070185661, 39.743175950288055],
                            [-104.99821601856591, 39.742944950287885],
                            [-104.99825601856584, 39.7427439502879],
                            [-104.99823501856578, 39.74223795028781],
                            [-104.99713701856604, 39.7413859502877],
                            [-104.99612001856646, 39.74079095028769],
                            [-104.99371901856811, 39.74265095028856],
                            [-104.99285801856843, 39.74197795028842],
                            [-104.99111501856899, 39.74063695028852],
                            [-104.99165201856862, 39.74020095028829],
                            [-104.99165501856812, 39.73844395028804],
                            [-104.99024001856885, 39.73844795028825],
                            [-104.9900670185689, 39.738396950288106],
                            [-104.98932501856919, 39.73784995028819],
                            [-104.98906301856924, 39.73778195028829],
                            [-104.98866201856949, 39.73786695028843],
                            [-104.98792301857007, 39.73838495028855],
                            [-104.98772101857008, 39.73844295028861],
                            [-104.98741301857031, 39.73843095028852],
                            [-104.98739301856983, 39.7368489502882],
                            [-104.98740001856939, 39.73525895028794],
                            [-104.98884101856859, 39.735251950287676],
                            [-104.98884301856828, 39.73385195028734],
                            [-104.98741501856908, 39.733854950287665],
                            [-104.98740301856856, 39.732042950287266],
                            [-104.98740301856786, 39.729364950286644],
                            [-104.9874140185673, 39.727308950286265],
                            [-104.98742901856716, 39.72666695028611],
                            [-104.98881801856658, 39.72733695028606],
                            [-104.98885901856649, 39.727212950286095],
                            [-104.98887801856614, 39.72564995028573],
                            [-104.98743501856683, 39.72563695028591],
                            [-104.98748201856638, 39.724135950285586],
                            [-104.98748501856595, 39.722534950285294],
                            [-104.98951201856485, 39.722539950285025],
                            [-104.99189501856371, 39.72253695028461],
                            [-104.99613201856147, 39.72252495028378],
                            [-104.99857701856028, 39.72253195028349],
                            [-105.00018201855944, 39.722527950283244],
                            [-105.00018201855902, 39.72092495028297],
                            [-105.00134001855875, 39.72221595028292],
                            [-105.00180201855868, 39.72265195028298],
                            [-105.0020140185586, 39.72288895028303],
                            [-105.00250801855863, 39.72351195028314],
                            [-105.0038080185582, 39.724762950283115],
                            [-105.00475001855803, 39.72565795028317],
                            [-105.00578001855747, 39.72566495028305],
                            [-105.00563401855743, 39.72537095028301],
                            [-105.00560001855739, 39.725156950283],
                            [-105.00554801855625, 39.72092595028198],
                            [-105.00623301855593, 39.72092595028189],
                            [-105.00664901855696, 39.72536995028272],
                            [-105.00709701855668, 39.72536995028266],
                            [-105.00712301855557, 39.721150950281746],
                            [-105.00702001855554, 39.720926950281864],
                            [-105.0075860185553, 39.72090695028171],
                            [-105.00894901855457, 39.72092795028162],
                            [-105.00938201855438, 39.72132395028154],
                            [-105.00963301855431, 39.721501950281535],
                            [-105.01005701855422, 39.721745950281424],
                            [-105.01088101855382, 39.72197195028141],
                            [-105.01205701855335, 39.722233950281286],
                            [-105.0124590185531, 39.72234795028124],
                            [-105.012810018553, 39.72249795028122],
                            [-105.01302001855298, 39.72266495028115],
                            [-105.01388701855262, 39.72316395028121],
                            [-105.01452101855246, 39.72356995028122],
                            [-105.0151440185522, 39.723909950281055],
                            [-105.01539201855213, 39.72407595028113],
                            [-105.01579201855198, 39.724554950281146],
                            [-105.01584601855204, 39.72472795028115],
                            [-105.01576801855231, 39.725501950281426],
                            [-105.01677901855182, 39.725427950281144],
                            [-105.01806601855107, 39.72518595028093],
                            [-105.01866901855071, 39.72518495028079],
                            [-105.01867301855061, 39.72486395028078],
                            [-105.01751401855122, 39.724875950280875],
                            [-105.01749801855088, 39.723881950280685],
                            [-105.01585401855185, 39.72388195028113],
                            [-105.01571201855181, 39.72385095028105],
                            [-105.01526401855196, 39.72338895028099],
                            [-105.01520501855188, 39.723264950281006],
                            [-105.01520601855158, 39.72206995028065],
                            [-105.01866301854993, 39.72203695028021],
                            [-105.01866001855034, 39.723882950280554],
                            [-105.02097901854926, 39.72388095028025],
                            [-105.02097301854896, 39.722900950279964],
                            [-105.02211301854838, 39.722893950279676],
                            [-105.02211401854828, 39.72248595027976],
                            [-105.02445501854697, 39.7224579502794],
                            [-105.02473001854705, 39.72289895027935],
                            [-105.02511501854673, 39.722899950279356],
                            [-105.02512701854695, 39.72349195027947],
                            [-105.02513501854753, 39.72554195027985],
                            [-105.02893501854561, 39.72556495027918],
                            [-105.03072701854467, 39.725565950278984],
                            [-105.03169801854423, 39.72557595027877],
                            [-105.03248401854383, 39.72562195027876],
                            [-105.03247901854355, 39.72451995027846],
                            [-105.03126101854414, 39.724527950278585],
                            [-105.03125301854368, 39.72292895027831],
                            [-105.03395001854236, 39.72292795027774],
                            [-105.03841301854, 39.72293995027719],
                            [-105.0428150185377, 39.72296395027649],
                            [-105.04393701853724, 39.722973950276284],
                            [-105.04393001853703, 39.72213395027625],
                            [-105.0450750185364, 39.72215195027598],
                            [-105.04952401853421, 39.72218495027529],
                            [-105.05208901853284, 39.72221595027496],
                            [-105.05208801853287, 39.72226195027488],
                            [-105.05259301853266, 39.722334950274856]
                        ]
                    ]
                },
                "properties": { "OBJECTID": 279, "ZCTA5CE10": "80204", "GEOID10": "80204" }
            },
            {
                "zipCode": 80202,
                "type": "Feature",
                "geometry": {
                    "type": "Polygon",
                    "coordinates": [
                        [
                            [-105.00948901856323, 39.75392595028837],
                            [-105.01012001856299, 39.75426095028835],
                            [-105.01170701856233, 39.755008950288286],
                            [-105.01269201856195, 39.755367950288274],
                            [-105.01021501856371, 39.75717495028899],
                            [-105.01007401856373, 39.757066950288916],
                            [-105.00898401856449, 39.757850950289324],
                            [-105.00832401856498, 39.75830295028941],
                            [-105.00756601856548, 39.758862950289824],
                            [-105.0062310185664, 39.7597739502901],
                            [-105.0050690185672, 39.760480950290514],
                            [-105.00411701856783, 39.76108495029064],
                            [-105.00345801856835, 39.76156095029101],
                            [-105.00288401856871, 39.76206495029113],
                            [-105.0027010185689, 39.76228395029122],
                            [-105.00253801856897, 39.762838950291425],
                            [-105.00240801856926, 39.76308095029149],
                            [-105.00175401856986, 39.76395795029172],
                            [-105.00059201857074, 39.76539995029231],
                            [-105.00014501857115, 39.76582395029237],
                            [-104.99968901857142, 39.76615895029252],
                            [-104.99912201857187, 39.7664959502927],
                            [-104.99866701857205, 39.76671295029282],
                            [-104.99820601857243, 39.766893950292996],
                            [-104.99827601857214, 39.76598595029281],
                            [-104.99823501857156, 39.76378895029244],
                            [-104.99829901857129, 39.76308195029224],
                            [-104.99835501857103, 39.76209295029191],
                            [-104.99790901857115, 39.76221095029199],
                            [-104.99760801857148, 39.76236995029207],
                            [-104.99727001857171, 39.76247495029211],
                            [-104.99659901857204, 39.76254895029234],
                            [-104.9961920185723, 39.76269295029245],
                            [-104.99550601857266, 39.762988950292645],
                            [-104.99517501857292, 39.76319795029275],
                            [-104.9947980185733, 39.763485950292726],
                            [-104.99475201857275, 39.76191495029245],
                            [-104.99476501857266, 39.76151095029235],
                            [-104.99471001857263, 39.76090595029223],
                            [-104.99453801857263, 39.76041695029218],
                            [-104.99426801857264, 39.75997495029217],
                            [-104.9938310185727, 39.75951095029212],
                            [-104.99359701857267, 39.75932995029206],
                            [-104.9937280185726, 39.75924195029201],
                            [-104.99477501857187, 39.758405950291795],
                            [-104.99537901857134, 39.757801950291515],
                            [-104.99629301857078, 39.75708095029104],
                            [-104.99641001857069, 39.75704895029102],
                            [-104.99704101857027, 39.75670295029104],
                            [-104.99718201857016, 39.75660195029098],
                            [-104.99611901857054, 39.75572795029095],
                            [-104.99427201857105, 39.75433395029089],
                            [-104.99341801857135, 39.75365295029084],
                            [-104.99259701857152, 39.75294395029099],
                            [-104.99169001857179, 39.75228795029088],
                            [-104.99083001857213, 39.75158895029093],
                            [-104.98997501857228, 39.75094095029096],
                            [-104.98877401857315, 39.75186095029123],
                            [-104.98789801857343, 39.75119195029133],
                            [-104.98910101857257, 39.75025295029087],
                            [-104.99031101857167, 39.74932195029055],
                            [-104.98944601857201, 39.748649950290535],
                            [-104.98822701857284, 39.7495859502909],
                            [-104.98727601857314, 39.74883895029073],
                            [-104.98646801857332, 39.74823995029077],
                            [-104.98610601857351, 39.74794095029091],
                            [-104.98610501857337, 39.74752595029072],
                            [-104.98720101857285, 39.74752195029062],
                            [-104.98739501857264, 39.74734495029042],
                            [-104.98740801857238, 39.746191950290346],
                            [-104.98611901857306, 39.74619195029056],
                            [-104.9861170185727, 39.744888950290274],
                            [-104.98741601857205, 39.744884950289965],
                            [-104.98737601857152, 39.74335695028969],
                            [-104.98726401857161, 39.74329195028964],
                            [-104.98611501857226, 39.74327895028996],
                            [-104.98611601857183, 39.74167795028949],
                            [-104.9861350185714, 39.74006195028922],
                            [-104.98625801857126, 39.740112950289145],
                            [-104.98738901857081, 39.74010595028891],
                            [-104.98741301857031, 39.73843095028852],
                            [-104.98772101857008, 39.73844295028861],
                            [-104.98792301857007, 39.73838495028855],
                            [-104.98866201856949, 39.73786695028843],
                            [-104.98906301856924, 39.73778195028829],
                            [-104.98932501856919, 39.73784995028819],
                            [-104.9900670185689, 39.738396950288106],
                            [-104.99024001856885, 39.73844795028825],
                            [-104.99165501856812, 39.73844395028804],
                            [-104.99165201856862, 39.74020095028829],
                            [-104.99111501856899, 39.74063695028852],
                            [-104.99285801856843, 39.74197795028842],
                            [-104.99371901856811, 39.74265095028856],
                            [-104.99612001856646, 39.74079095028769],
                            [-104.99713701856604, 39.7413859502877],
                            [-104.99823501856578, 39.74223795028781],
                            [-104.99825601856584, 39.7427439502879],
                            [-104.99821601856591, 39.742944950287885],
                            [-104.9980070185661, 39.743175950288055],
                            [-104.99738301856651, 39.74361195028807],
                            [-104.99749801856659, 39.74371495028827],
                            [-104.99635001856737, 39.74466495028854],
                            [-104.99717601856707, 39.74532295028848],
                            [-104.99804701856678, 39.7459879502886],
                            [-104.99895901856662, 39.74666495028866],
                            [-105.00014801856574, 39.745752950288136],
                            [-105.00042101856559, 39.74551895028808],
                            [-105.00043601856561, 39.74601595028822],
                            [-105.00051201856574, 39.74664795028822],
                            [-105.0005730185658, 39.746803950288204],
                            [-105.00081301856562, 39.7466899502883],
                            [-105.00111701856562, 39.74694995028835],
                            [-105.00228201856517, 39.74769395028825],
                            [-105.0025690185651, 39.74791195028832],
                            [-105.00308701856501, 39.74851295028815],
                            [-105.00373101856485, 39.749347950288396],
                            [-105.0041180185648, 39.74972395028826],
                            [-105.00636501856405, 39.751420950288356],
                            [-105.00661601856406, 39.75164095028844],
                            [-105.00604001856443, 39.75208395028852],
                            [-105.0069680185642, 39.75278995028851],
                            [-105.00760901856398, 39.753304950288474],
                            [-105.00782701856394, 39.753507950288565],
                            [-105.00791701856394, 39.7536999502887],
                            [-105.00798301856393, 39.75399595028856],
                            [-105.00816701856404, 39.75454495028874],
                            [-105.00818601856406, 39.75479095028874],
                            [-105.00857801856388, 39.75472995028876],
                            [-105.00906901856347, 39.754384950288454],
                            [-105.00948901856323, 39.75392595028837]
                        ],
                        [
                            [-104.99096601857048, 39.746117950289666],
                            [-104.99009401857084, 39.74544595028966],
                            [-104.98890201857165, 39.746379950290084],
                            [-104.9897840185714, 39.74706495029012],
                            [-104.99096601857048, 39.746117950289666]
                        ]
                    ]
                },
                "properties": { "OBJECTID": 277, "ZCTA5CE10": "80202", "GEOID10": "80202" }
            }
        ];

    var propTable = {
        props: [
            // {
            //         "id": 1011,
            //         "properties": {
            //             "popupContent": "This is the Auraria West Campus",
            //             "style": {
            //                 weight: 2,
            //                 color: "#999",
            //                 opacity: 1,
            //                 fillColor: "#B0DE5C",
            //                 fillOpacity: 0.8
            //             }
            //         }
            //     },
            { "zipCode": 80237, "properties": { "medianSold2017": "306250", "medianSold2018": "428500", "medianPctChange": "0.3991836735" } },
            { "zipCode": 80230, "properties": { "medianSold2017": "522000", "medianSold2018": "729402", "medianPctChange": "0.3973218391" } },
            { "zipCode": 80223, "properties": { "medianSold2017": "295000", "medianSold2018": "411000", "medianPctChange": "0.393220339" } },
            { "zipCode": 80125, "properties": { "medianSold2017": "407450", "medianSold2018": "540000", "medianPctChange": "0.3253159897" } },
            { "zipCode": 80401, "properties": { "medianSold2017": "447500", "medianSold2018": "579000", "medianPctChange": "0.2938547486" } },
            { "zipCode": 80121, "properties": { "medianSold2017": "436000", "medianSold2018": "545000", "medianPctChange": "0.25" } },
            { "zipCode": 80236, "properties": { "medianSold2017": "305000", "medianSold2018": "379000", "medianPctChange": "0.2426229508" } },
            { "zipCode": 80111, "properties": { "medianSold2017": "545000", "medianSold2018": "667300", "medianPctChange": "0.2244036697" } },
            { "zipCode": 80214, "properties": { "medianSold2017": "324000", "medianSold2018": "396000", "medianPctChange": "0.2222222222" } },
            { "zipCode": 80247, "properties": { "medianSold2017": "192500", "medianSold2018": "234750", "medianPctChange": "0.2194805195" } },
            { "zipCode": 80216, "properties": { "medianSold2017": "243000", "medianSold2018": "290000", "medianPctChange": "0.1934156379" } },
            { "zipCode": 80010, "properties": { "medianSold2017": "245099", "medianSold2018": "292500", "medianPctChange": "0.1933953219" } },
            { "zipCode": 80224, "properties": { "medianSold2017": "360000", "medianSold2018": "427500", "medianPctChange": "0.1875" } },
            { "zipCode": 80212, "properties": { "medianSold2017": "462500", "medianSold2018": "541000", "medianPctChange": "0.1697297297" } },
            { "zipCode": 80222, "properties": { "medianSold2017": "372500", "medianSold2018": "430000", "medianPctChange": "0.1543624161" } },
            { "zipCode": 80124, "properties": { "medianSold2017": "526250", "medianSold2018": "606250", "medianPctChange": "0.1520190024" } },
            { "zipCode": 80130, "properties": { "medianSold2017": "419900", "medianSold2018": "480000", "medianPctChange": "0.1431293165" } },
            { "zipCode": 80219, "properties": { "medianSold2017": "276000", "medianSold2018": "315000", "medianPctChange": "0.1413043478" } },
            { "zipCode": 80122, "properties": { "medianSold2017": "385000", "medianSold2018": "437000", "medianPctChange": "0.1350649351" } },
            { "zipCode": 80210, "properties": { "medianSold2017": "600000", "medianSold2018": "680000", "medianPctChange": "0.1333333333" } },
            { "zipCode": 80002, "properties": { "medianSold2017": "322500", "medianSold2018": "365250", "medianPctChange": "0.1325581395" } },
            { "zipCode": 80129, "properties": { "medianSold2017": "415000", "medianSold2018": "470000", "medianPctChange": "0.1325301205" } },
            { "zipCode": 80030, "properties": { "medianSold2017": "270000", "medianSold2018": "305500", "medianPctChange": "0.1314814815" } },
            { "zipCode": 80027, "properties": { "medianSold2017": "524000", "medianSold2018": "591000", "medianPctChange": "0.1278625954" } },
            { "zipCode": 80204, "properties": { "medianSold2017": "418000", "medianSold2018": "470000", "medianPctChange": "0.1244019139" } },
            { "zipCode": 80221, "properties": { "medianSold2017": "302500", "medianSold2018": "340000", "medianPctChange": "0.1239669421" } },
            { "zipCode": 80205, "properties": { "medianSold2017": "418750", "medianSold2018": "470000", "medianPctChange": "0.1223880597" } },
            { "zipCode": 80031, "properties": { "medianSold2017": "325000", "medianSold2018": "364750", "medianPctChange": "0.1223076923" } },
            { "zipCode": 80601, "properties": { "medianSold2017": "323590", "medianSold2018": "363000", "medianPctChange": "0.1217899193" } },
            { "zipCode": 80218, "properties": { "medianSold2017": "330000", "medianSold2018": "369500", "medianPctChange": "0.1196969697" } },
            { "zipCode": 80022, "properties": { "medianSold2017": "322000", "medianSold2018": "360000", "medianPctChange": "0.1180124224" } },
            { "zipCode": 80231, "properties": { "medianSold2017": "246000", "medianSold2018": "275000", "medianPctChange": "0.1178861789" } },
            { "zipCode": 80249, "properties": { "medianSold2017": "300000", "medianSold2018": "335000", "medianPctChange": "0.1166666667" } },
            { "zipCode": 80239, "properties": { "medianSold2017": "270000", "medianSold2018": "301110", "medianPctChange": "0.1152222222" } },
            { "zipCode": 80209, "properties": { "medianSold2017": "621000", "medianSold2018": "692500", "medianPctChange": "0.115136876" } },
            { "zipCode": 80011, "properties": { "medianSold2017": "262000", "medianSold2018": "292000", "medianPctChange": "0.1145038168" } },
            { "zipCode": 80229, "properties": { "medianSold2017": "265000", "medianSold2018": "295000", "medianPctChange": "0.1132075472" } },
            { "zipCode": 80303, "properties": { "medianSold2017": "540000", "medianSold2018": "600450", "medianPctChange": "0.1119444444" } },
            { "zipCode": 80603, "properties": { "medianSold2017": "301400", "medianSold2018": "335000", "medianPctChange": "0.1114797611" } },
            { "zipCode": 80013, "properties": { "medianSold2017": "305000", "medianSold2018": "339000", "medianPctChange": "0.1114754098" } },
            { "zipCode": 80104, "properties": { "medianSold2017": "362750", "medianSold2018": "403000", "medianPctChange": "0.11095796" } },
            { "zipCode": 80207, "properties": { "medianSold2017": "419000", "medianSold2018": "465000", "medianPctChange": "0.1097852029" } },
            { "zipCode": 80110, "properties": { "medianSold2017": "322500", "medianSold2018": "357000", "medianPctChange": "0.1069767442" } },
            { "zipCode": 80234, "properties": { "medianSold2017": "334250", "medianSold2018": "370000", "medianPctChange": "0.1069558714" } },
            { "zipCode": 80202, "properties": { "medianSold2017": "479000", "medianSold2018": "530000", "medianPctChange": "0.1064718163" } },
            { "zipCode": 80602, "properties": { "medianSold2017": "398500", "medianSold2018": "440075", "medianPctChange": "0.1043287327" } },
            { "zipCode": 80126, "properties": { "medianSold2017": "468000", "medianSold2018": "515000", "medianPctChange": "0.1004273504" } },
            { "zipCode": 80014, "properties": { "medianSold2017": "245250", "medianSold2018": "269500", "medianPctChange": "0.09887869521" } },
            { "zipCode": 80233, "properties": { "medianSold2017": "298500", "medianSold2018": "327500", "medianPctChange": "0.09715242881" } },
            { "zipCode": 80109, "properties": { "medianSold2017": "420000", "medianSold2018": "459950", "medianPctChange": "0.09511904762" } },
            { "zipCode": 80005, "properties": { "medianSold2017": "400000", "medianSold2018": "436500", "medianPctChange": "0.09125" } },
            { "zipCode": 80241, "properties": { "medianSold2017": "339359", "medianSold2018": "370000", "medianPctChange": "0.09029081297" } },
            { "zipCode": 80123, "properties": { "medianSold2017": "349159", "medianSold2018": "380000", "medianPctChange": "0.08832938575" } },
            { "zipCode": 80015, "properties": { "medianSold2017": "359900", "medianSold2018": "390000", "medianPctChange": "0.08363434287" } },
            { "zipCode": 80112, "properties": { "medianSold2017": "365000", "medianSold2018": "395500", "medianPctChange": "0.08356164384" } },
            { "zipCode": 80003, "properties": { "medianSold2017": "337500", "medianSold2018": "365000", "medianPctChange": "0.08148148148" } },
            { "zipCode": 80033, "properties": { "medianSold2017": "370000", "medianSold2018": "400000", "medianPctChange": "0.08108108108" } },
            { "zipCode": 80020, "properties": { "medianSold2017": "365400", "medianSold2018": "395000", "medianPctChange": "0.08100711549" } },
            { "zipCode": 80017, "properties": { "medianSold2017": "256500", "medianSold2018": "276700", "medianPctChange": "0.07875243665" } },
            { "zipCode": 80004, "properties": { "medianSold2017": "380300", "medianSold2018": "410000", "medianPctChange": "0.07809623981" } },
            { "zipCode": 80215, "properties": { "medianSold2017": "416500", "medianSold2018": "448250", "medianPctChange": "0.0762304922" } },
            { "zipCode": 80127, "properties": { "medianSold2017": "399900", "medianSold2018": "430000", "medianPctChange": "0.0752688172" } },
            { "zipCode": 80016, "properties": { "medianSold2017": "479450", "medianSold2018": "514900", "medianPctChange": "0.07393888831" } },
            { "zipCode": 80007, "properties": { "medianSold2017": "525000", "medianSold2018": "562450", "medianPctChange": "0.07133333333" } },
            { "zipCode": 80134, "properties": { "medianSold2017": "435000", "medianSold2018": "465000", "medianPctChange": "0.06896551724" } },
            { "zipCode": 80220, "properties": { "medianSold2017": "427200", "medianSold2018": "456500", "medianPctChange": "0.06858614232" } },
            { "zipCode": 80021, "properties": { "medianSold2017": "345500", "medianSold2018": "368000", "medianPctChange": "0.06512301013" } },
            { "zipCode": 80203, "properties": { "medianSold2017": "306250", "medianSold2018": "325500", "medianPctChange": "0.06285714286" } },
            { "zipCode": 80120, "properties": { "medianSold2017": "401000", "medianSold2018": "425000", "medianPctChange": "0.05985037406" } },
            { "zipCode": 80135, "properties": { "medianSold2017": "567500", "medianSold2018": "600000", "medianPctChange": "0.05726872247" } },
            { "zipCode": 80232, "properties": { "medianSold2017": "339750", "medianSold2018": "358500", "medianPctChange": "0.05518763797" } },
            { "zipCode": 80012, "properties": { "medianSold2017": "232250", "medianSold2018": "245000", "medianPctChange": "0.0548977395" } },
            { "zipCode": 80113, "properties": { "medianSold2017": "421500", "medianSold2018": "444250", "medianPctChange": "0.05397390273" } },
            { "zipCode": 80228, "properties": { "medianSold2017": "403000", "medianSold2018": "424500", "medianPctChange": "0.05334987593" } },
            { "zipCode": 80138, "properties": { "medianSold2017": "458875", "medianSold2018": "481229", "medianPctChange": "0.04871479161" } },
            { "zipCode": 80018, "properties": { "medianSold2017": "369500", "medianSold2018": "387000", "medianPctChange": "0.04736129905" } },
            { "zipCode": 80260, "properties": { "medianSold2017": "243500", "medianSold2018": "255000", "medianPctChange": "0.04722792608" } },
            { "zipCode": 80128, "properties": { "medianSold2017": "350500", "medianSold2018": "366000", "medianPctChange": "0.04422253923" } },
            { "zipCode": 80226, "properties": { "medianSold2017": "360000", "medianSold2018": "371250", "medianPctChange": "0.03125" } },
            { "zipCode": 80211, "properties": { "medianSold2017": "525000", "medianSold2018": "540000", "medianPctChange": "0.02857142857" } },
            { "zipCode": 80238, "properties": { "medianSold2017": "540000", "medianSold2018": "555000", "medianPctChange": "0.02777777778" } },
            { "zipCode": 80465, "properties": { "medianSold2017": "402000", "medianSold2018": "413000", "medianPctChange": "0.02736318408" } },
            { "zipCode": 80403, "properties": { "medianSold2017": "527200", "medianSold2018": "540000", "medianPctChange": "0.02427921093" } },
            { "zipCode": 80108, "properties": { "medianSold2017": "557475", "medianSold2018": "564750", "medianPctChange": "0.01304991255" } },
            { "zipCode": 80227, "properties": { "medianSold2017": "315000", "medianSold2018": "303750", "medianPctChange": "-0.03571428571" } },
            { "zipCode": 80206, "properties": { "medianSold2017": "639500", "medianSold2018": "615250", "medianPctChange": "-0.0379202502" } },
            { "zipCode": 80640, "properties": { "medianSold2017": "340000", "medianSold2018": "320000", "medianPctChange": "-0.05882352941" } },
            { "zipCode": 80235, "properties": { "medianSold2017": "300000", "medianSold2018": "260750", "medianPctChange": "-0.1308333333" } }

        ]
    };

    //returns objects with a matching key
    function getObjects(obj, key, val) {
        var objects = [];
        for (var i in obj) {
            if (!obj.hasOwnProperty(i)) continue;
            if (typeof obj[i] == 'object') {
                objects = objects.concat(getObjects(obj[i], key, val));
            } else if (i == key && obj[key] == val) {
                objects.push(obj);
            }
        }
        return objects;
    }

    //takes in separate geometry and properties objects, links them by an id field
    //and creates a GeoJSON feature collection
    function mergeProperties(geom, props, zipCode) {
        //create empty feature collection for merged features
        var newgeom = {
            type: "FeatureCollection",
            features: []
        };
        //if original geometry is a feature collection, loop through all features
        if (geom.type == "FeatureCollection") {
            for (var i in geom.features) {
                var key = geom.features[i][zipCode];
                var g = geom.features[i].geometry;
                //skip this loop if there is no id in the geometry
                if (key === undefined) continue;
                //extract properties that match the geometry id
                var p = getObjects(props, zipCode, key);
                //populate new geometry
                newgeom.features.push({
                    "zipCode": key,
                    "type": "Feature",
                    "geometry": g,
                    "properties": p[0].properties
                });
            }
            //if it's a single feature, just get the single object
        } else if (geom.type == "Feature") {
            var key = geom[zipCode];
            var g = geom.geometry;
            if (key !== undefined) {
                var p = getObjects(props, zipCode, key);
                newgeom.features.push({
                    "zipCode": key,
                    "type": "Feature",
                    "geometry": g,
                    "properties": p[0].properties
                });
            }
            //if it's a geometry collection (with ids within each geometry), add the geometries as features
        } else if (geom.type == "GeometryCollection") {
            for (var i in geom.geometries) {
                var key = geom.geometries[i][zipCode];
                var g = geom.geometries[i];
                if (key === undefined) continue;
                var p = getObjects(props, zipCode, key);
                newgeom.features.push({
                    "zipCode": key,
                    "type": "Feature",
                    "geometry": g,
                    "properties": p[0].properties
                });
            }
        }
        return newgeom;
    }

    // console.log(collectionGeom.geometries[0]);
    // console.log(collectionGeom.geometries[0]["zipCode"]);

    campus = mergeProperties(campusGeom, propTable, "zipCode");

    console.log(campus);

    var baseballIcon = L.icon({
        iconUrl: 'http://leafletjs.com/examples/baseball-marker.png',
        iconSize: [32, 37],
        iconAnchor: [16, 37],
        popupAnchor: [0, -28]
    });

    function onEachFeature(feature, layer) {
        var popupContent = "<p>I started out as a GeoJSON " + feature.geometry.type + ", but now I'm a Leaflet vector!</p>";

        if (feature.properties && feature.properties.medianSold2018) {
            popupContent += feature.properties.medianSold2018;
        }

        layer.bindPopup(popupContent);
    }

    L.geoJson([campus], {

        style: function(feature) {
            return feature.properties && feature.properties.style;
        },

        onEachFeature: onEachFeature,

        pointToLayer: function(feature, latlng) {
            return L.circleMarker(latlng, {
                radius: 8,
                fillColor: "#ff7800",
                color: "#000",
                weight: 1,
                opacity: 1,
                fillOpacity: 0.8
            });
        }
    }).addTo(map);
    </script>
</body>

</html>